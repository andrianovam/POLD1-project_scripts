setwd(dirname(this.path()))
library(ggridges)
library(viridis)
library(ggtext)
library(this.path)
library(MutationalPatterns)
library(gridExtra)
library(ggplot2)
library(lsa)
library(sigfit)
setwd(dirname(this.path()))
#Figure 4a
df = read.table("Input_files/Figure4A_hyper_ultra_mutability.txt", header=T, sep="\t")
df = df[df$Status!="PolD_MSI-H-nonfunctional",]
df = df[df$Status!="PolD_PolE",]
status_levels = c("MSS", "PolE_MSS", "MSI", "PolD_MSI-H", "PolE_MSI-H", "POLE", "POLD1")
mut_per_mb_413711TT	= 226.0333333
mut_per_mb_second_tumour	= 96.4
mut_per_mb_hypermutable_polyps_stratton = mean(c(241677/3000,236160/3000, 233453/3000))
(ggplot(df, aes(y=factor(Status,levels = status_levels), x=Mut_per_mb,fill=Tissue))
+ geom_density_ridges(alpha=0.7)+scale_x_continuous(trans='log',breaks=c(10,100))
+ theme_bw()
+ scale_fill_brewer(palette = "Dark2")
+ geom_vline(xintercept = 10,linetype='dashed', col="darkgrey")
+ geom_vline(xintercept = 100,linetype='dashed', col="darkgrey")
+ annotate("point", x = mut_per_mb_413711TT, y = 7, col="#7570B3", size=2)
+ annotate('point', x = mut_per_mb_second_tumour, y = 7, col="#7570B3", size=2)
+ annotate('point', x = mut_per_mb_hypermutable_polyps_stratton, y = 7, col='#D95F02', size=2)
+ ylab("")
+ xlab("Mutations per megabase")
+ annotate("text", x = 1, y = 8.5,label = "Nonmutable", size=2)
+ annotate("text", x = 30, y = 8.5, label = "Hypermutable", size=2)
+ annotate("text", x = 500, y = 8.5, label = "Ultrahypermutable", size=2)
+ theme(legend.position = 'top')
+ theme(legend.key.size = unit(0.4, "cm"))
+ theme(legend.margin =margin(r=10,l=5,t=0,b=0))
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ theme(axis.text.y = element_markdown())
+ scale_y_discrete(expand = expansion(mult = c(0, 0.3)), labels=c("POLD1" = "*POLD1exo-*", "POLE" = "*POLEexo-*", "PolE_MSI-H" = "MMRd *POLEexo-*", "PolD_MSI-H" = "MMRd *POLD1exo-*", "MSI" = "MMRd", "PolE_MSS" = "*POLEexo-*", "MSS"="MMR proficiency<br>proofread proficiency")))
