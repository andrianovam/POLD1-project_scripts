+geom_point()
+geom_smooth(method="lm")
+theme_bw()
+scale_color_manual(values=c("plum2","purple4"), name="POLD1")
+theme(legend.position = 'bottom')
+xlab("Late <--- Replication timing ---> Early")
+ylab("TCT>TAT mutation rate")
+theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10)))
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum2","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = paste(after_stat(eq.label),
after_stat(rr.label), sep = "*\", \"*"))))
library(ggpmisc)
install.packages("ggmisc")
install.packages("ggpp")
library(ggpp)
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum2","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = paste(after_stat(eq.label),
after_stat(rr.label), sep = "*\", \"*"))))
install.packages("ggpmisc")
library(ggpmisc)
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum2","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = paste(after_stat(eq.label),
after_stat(rr.label), sep = "*\", \"*"))))
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum2","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label))))
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label))))
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum4","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label))))
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label))))
?stat_poly_eq
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = "left"))
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 1))
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9))
summary(model <- glm(data = x,cbind(N_mut, Nonmut) ~ Mut_type+rt_bin+Mut_type*rt_bin, family="binomial"))
head(y)
summary(model <- glm(data = x,cbind(N_mut, Nonmut) ~ Mut_type+rt_bin+Mut_type*rt_bin, family="binomial"))
summary(model <- glm(data = x,cbind(N_mut, Nonmut) ~ Mut_type+rt_bin+Mut_type*rt_bin, family="binomial"))$p.val
summary(model <- glm(data = x,cbind(N_mut, Nonmut) ~ Mut_type+rt_bin+Mut_type*rt_bin, family="binomial"))$coefficients
summary(model <- glm(data = x,cbind(N_mut, Nonmut) ~ Mut_type+rt_bin+Mut_type*rt_bin, family="binomial"))$coefficients
class(summary(model <- glm(data = x,cbind(N_mut, Nonmut) ~ Mut_type+rt_bin+Mut_type*rt_bin, family="binomial"))$coefficients)
summary(model <- glm(data = x,cbind(N_mut, Nonmut) ~ Mut_type+rt_bin+Mut_type*rt_bin, family="binomial"))$coefficients[1,]
summary(model <- glm(data = x,cbind(N_mut, Nonmut) ~ Mut_type+rt_bin+Mut_type*rt_bin, family="binomial"))$coefficients[4,]
summary(model <- glm(data = x,cbind(N_mut, Nonmut) ~ Mut_type+rt_bin+Mut_type*rt_bin, family="binomial"))$coefficients[4,4]
model <- glm(data = x,cbind(N_mut, Nonmut) ~ Mut_type+rt_bin+Mut_type*rt_bin, family="binomial")
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9)
+ grid.text(summary(model)$coefficients[4,4], x= 45, y = 5, gp=gpar(cex=0.7)))
library(grid)
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9)
+ grid.text(summary(model)$coefficients[4,4], x= 45, y = 5, gp=gpar(cex=0.7)))
summary(model)$coefficients[4,4]
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9)
+ grid.text(summary(model)$coefficients[4,4], x= 45, y = 5, gp=gpar(cex=0.7))
+ grid.text("bgkjnbgj")
)
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9)
#  + grid.text(summary(model)$coefficients[4,4], x= 45, y = 5, gp=gpar(cex=0.7))
+ grid.text("bgkjnbgj")
)
rlang::last_error()
rlang::last_trace()
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9)
+  annotate(geom="text", x=40, y=5, label=summary(model)$coefficients[4,4], color="red")
)
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9)
+  annotate(geom="text", x=40, y=5, label=paste("p-val=", summary(model)$coefficients[4,4], sep=""))
)
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9)
+  annotate(geom="text", x=40, y=5, label=paste("p-val=", round(summary(model)$coefficients[4,4],3), sep=""))
)
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9)
+  annotate(geom="text", x=40, y=5, label=paste("p-val=","<2e-16", sep=""))
)
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9)
+  annotate(geom="text", x=40, y=5, label=paste("p-val","<2e-16", sep=""))
)
tiff(filename="Output_plots/Figure4e_mutrate_vs_rt_homo_hetero.tiff", width=8, height=7, res=300, units='cm')
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9)
+  annotate(geom="text", x=40, y=5, label=paste("p-val","<2e-16", sep=""))
)
dev.off()
?stat_poly_eq
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9, hstep0=3)
+  annotate(geom="text", x=40, y=5, label=paste("p-val","<2e-16", sep=""))
)
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9, hstep=3)
+  annotate(geom="text", x=40, y=5, label=paste("p-val","<2e-16", sep=""))
)
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9, hstep=5)
+  annotate(geom="text", x=40, y=5, label=paste("p-val","<2e-16", sep=""))
)
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9, hstep=50)
+  annotate(geom="text", x=40, y=5, label=paste("p-val","<2e-16", sep=""))
)
tiff(filename="Output_plots/Figure4e_mutrate_vs_rt_homo_hetero.tiff", width=8, height=7, res=300, units='cm')
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9, hstep=50)
+  annotate(geom="text", x=40, y=5, label=paste("p-val","<2e-16", sep=""))
)
dev.off()
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9, vstep=50)
+  annotate(geom="text", x=40, y=4, label=paste("p-val","<2e-16", sep=""))
)
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9, vstep=10)
+  annotate(geom="text", x=40, y=4, label=paste("p-val","<2e-16", sep=""))
)
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9, vstep=5)
+  annotate(geom="text", x=40, y=4, label=paste("p-val","<2e-16", sep=""))
)
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9, vstep=1)
+  annotate(geom="text", x=40, y=4, label=paste("p-val","<2e-16", sep=""))
)
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9, vstep=0.5)
+  annotate(geom="text", x=40, y=4, label=paste("p-val","<2e-16", sep=""))
)
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9, vstep=0.2)
+  annotate(geom="text", x=40, y=4, label=paste("p-val","<2e-16", sep=""))
)
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9, vstep=0.3)
+  annotate(geom="text", x=40, y=4, label=paste("p-val","<2e-16", sep=""))
)
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9, vstep=0.15)
+  annotate(geom="text", x=40, y=4, label=paste("p-val","<2e-16", sep=""))
)
tiff(filename="Output_plots/Figure4e_mutrate_vs_rt_homo_hetero.tiff", width=8, height=7, res=300, units='cm')
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.9, vstep=0.15)
+  annotate(geom="text", x=40, y=4, label=paste("p-val","<2e-16", sep=""))
)
dev.off()
tiff(filename="Output_plots/Figure4e_mutrate_vs_rt_homo_hetero.tiff", width=8, height=7, res=300, units='cm')
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.95, vstep=0.15)
+  annotate(geom="text", x=40, y=4, label=paste("p-val","<2e-16", sep=""), size=6)
)
dev.off()
tiff(filename="Output_plots/Figure4e_mutrate_vs_rt_homo_hetero.tiff", width=8, height=7, res=300, units='cm')
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.95, vstep=0.15)
+  annotate(geom="text", x=40, y=4, label=paste("p-val","<2e-16", sep=""), size=4)
)
dev.off()
tiff(filename="Output_plots/Figure4e_mutrate_vs_rt_homo_hetero.tiff", width=8, height=7, res=300, units='cm')
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.95, vstep=0.15)
+  annotate(geom="text", x=40, y=4, label=paste("p-val","<2e-16", sep=""), size=3)
)
dev.off()
tiff(filename="Output_plots/Figure4e_mutrate_vs_rt_homo_hetero.tiff", width=8, height=7, res=300, units='cm')
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.95, vstep=0.15)
+  annotate(geom="text", x=40, y=4, label=paste("p-val","<2e-16", sep=""), size=3.5)
)
dev.off()
tiff(filename="Output_plots/Figure4e_mutrate_vs_rt_homo_hetero.tiff", width=8, height=7, res=300, units='cm')
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.95, vstep=0.15, size=3)
+  annotate(geom="text", x=40, y=4, label=paste("p-val","<2e-16", sep=""), size=3.5)
)
dev.off()
tiff(filename="Output_plots/Figure4e_mutrate_vs_rt_homo_hetero.tiff", width=8, height=7, res=300, units='cm')
(ggplot(y, aes(x=rt_bin, y=mutrate_norm, group=Mut_type,col=Mut_type))
+ geom_point()
+ geom_smooth(method="lm")
+ theme_bw()
+ scale_color_manual(values=c("plum3","purple4"), name="POLD1")
+ theme(legend.position = 'bottom')
+ xlab("Late <--- Replication timing ---> Early")
+ ylab("TCT>TAT mutation rate")
+ theme(axis.text=element_text(size=8),axis.title=element_text(size=10),legend.text=element_text(size=8),legend.title=element_text(size=10))
+ stat_poly_eq(aes(label = after_stat(eq.label)),label.x = 0.95, vstep=0.15, size=4)
+  annotate(geom="text", x=40, y=4, label=paste("p-val","<2e-16", sep=""), size=3.5)
)
dev.off()
