install.packages("~/Downloads/ExomeCNV_1.4.tar.gz", repos = NULL, type = "source")
BiocManager::install("DNAcopy")
install.packages("~/Downloads/ExomeCNV_1.4.tar.gz", repos = NULL, type = "source")
library(ExomeCNV)
?`ExomeCNV-package`
log2(0.681-0.89)
0.681-0.89
log2(-0.681+0.89)
log2(-3)
log2(-0.681+0.89)
df1=read.table("/home/mandrianova/Lab/CH_project/CH_dynamics/published_data/GSE178936_LBC_ARCHER.1PCT_VAF.Feb22.non-synonymous.tsv")
head(df1)
df1=read.table("/home/mandrianova/Lab/CH_project/CH_dynamics/published_data/GSE178936_LBC_ARCHER.1PCT_VAF.Feb22.non-synonymous.tsv", sep="\t")
head(df1)
df1=read.table("/home/mandrianova/Lab/CH_project/CH_dynamics/published_data/GSE178936_LBC_ARCHER.1PCT_VAF.Feb22.non-synonymous.tsv", sep="\t", header=T)
head(df1)
len(unique(df1$participant_id))
length(unique(df1$participant_id))
df2=read.table("/home/mandrianova/Lab/CH_project/CH_dynamics/published_data/GSE178936_LBC_ARCHER.2PCT_VAF.Feb22.non-synonymous.tsv", sep="\t", header=T)
head(df2)
length(unique(df2$participant_id))
4.2*2.4
100/6
14*60*5000
42*2.4
100.8/3
14*60*5*2.4
10080/3
library(ggplot2)
library(ggtext)
library(dplyr)
library("MutationalPatterns")
library("this.path")
library(cowplot)
library(gridExtra)
library(reshape2)
library(ggpubr)
setwd(dirname(this.path()))
df = read.table("Input_files/Figure2A_signatures_fibros_p0_refitted.txt", header=T)
df$All_SNVs = df$SBS5 + df$SBS7a + df$SBS7b + df$SBS7d + df$SBS10c + df$SBS58
fit <- lm(All_SNVs ~ Age, data=df)
p_all =(ggplot(df, aes(x = Age, y=All_SNVs))
+ geom_point(aes(col=Status),size=2)
+ theme_bw()
+ xlim(0, 70)
+ geom_text(aes(col=Status, label=Samples), hjust=-0.3, vjust=0, col="black", size=2.5)
+ geom_abline(slope = coef(fit)[["Age"]],intercept = coef(fit)["(Intercept)"], col="darkgrey")
+ stat_cor()
+ scale_color_manual(values=c('orange','cornflowerblue'), name="*POLD1* status")
+theme(legend.position = "top")
+ ylab("SNVs number")
)
tiff(filename="Output_plots/Figure2b_nmut_vs_age.tiff", width=8, height=8, res=300, units='cm')
p_all
dev.off()
df = read.table("Input_files/Figure2A_signatures_fibros_p0_refitted.txt", header=T)
df$All_SNVs = df$SBS5 + df$SBS7a + df$SBS7b + df$SBS7d + df$SBS10c + df$SBS58
fit <- lm(All_SNVs ~ Age, data=df)
p_all =(ggplot(df, aes(x = Age, y=All_SNVs))
+ geom_point(aes(col=Status),size=2)
+ theme_bw()
+ xlim(0, 70)
+ geom_text(aes(col=Status, label=Samples), hjust=-0.3, vjust=0, col="black", size=2.5)
+ geom_abline(slope = coef(fit)[["Age"]],intercept = coef(fit)["(Intercept)"], col="darkgrey")
+ stat_cor()
+ scale_color_manual(values=c('orange','cornflowerblue'), name="POLD1 status")
+theme(legend.position = "top")
+ ylab("SNVs number")
)
tiff(filename="Output_plots/Figure2b_nmut_vs_age.tiff", width=8, height=8, res=300, units='cm')
p_all
dev.off()
